%---------------------------------%
% Report Template | Cannabis Tests
% Copyright (c) 2020-2023 Cannlytics
% Authors: Keegan Skeate <keegan@cannlytics.com>
% Created: 12/26/2020
% Updated: 7/16/2023
%---------------------------------%
\documentclass[11pt, leqno]{article}
\usepackage{geometry}
\geometry{
  a4paper,
  paperheight = 11in,
  paperwidth = 8.5in,
  top = 0.75in,
  bottom = 0.75in,
  right = 0.5in,
  left = 0.5in,
	headsep = 0.25in,
	columnsep = 20pt,
	heightrounded,
}

%---------------------------------%
% PDF properties.
%---------------------------------%

% Define the author and title.
\author{Keegan Skeate}
\title{Cannabis Intelligence: Cannabis Lab Tests for July 2023}

% Define the PDF properties.
\usepackage[bookmarks=true]{hyperref} % linktoc=page
\hypersetup{
  colorlinks=true,
  linkcolor = green,
  citecolor = green,
  filecolor = green,
  urlcolor = green,
  pdftitle = {Cannabis Intelligence: Cannabis Lab Tests for July 2023},
  pdfauthor = {Keegan Skeate},
  pdfsubject = {},
  pdfkeywords = {cannabis, testing, analytics},
  pdftoolbar = true,
  pdfmenubar = true,
}

% Make the image directory available.
\usepackage{graphicx}
\graphicspath{{images/}{../images/}} 

%---------------------------------%
% Packages
%---------------------------------%
\usepackage{afterpage}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{array} % For cover art.
\usepackage[english]{babel}
\usepackage{bbding} % Symbols.
\usepackage{booktabs}
\usepackage[
  singlelinecheck = off,
  labelsep = period,
  bf,
  font={sf, footnotesize}
]{caption}
\usepackage[dvipsnames, table]{xcolor} % Must be above tcolorbox.
\usepackage{colortbl} % For colored tables.
\usepackage{datetime} % For month names.
\usepackage{dsfont}
\usepackage{emptypage} % Empties blank pages.
\usepackage{enumerate} % For better lists.
\usepackage[inline]{enumitem}
\usepackage{epstopdf} % Converts eps figures.
\usepackage{fancyhdr} % For headers and footers.
\usepackage{floatrow}
\usepackage{fmtcount} % Word numbering.
\usepackage{footmisc} % Footnotes
\usepackage{footnotebackref}
\usepackage{gensymb} % Degree symbol.
\usepackage{ifthen}
\usepackage[utf8]{inputenc}
\usepackage{lastpage} % For references the last page.
\usepackage{listings} % For styling code snippets.
\usepackage{makecell} % Multi-line cells in tables.
\usepackage{mathrsfs}
\usepackage{multicol}
\usepackage[super]{nth} % For styling 1st, 2nd, 3rd, etc.
\usepackage{pdfpages} % Facilitates including other PDFs.
\usepackage{ragged2e} % For text alignment.
\usepackage{romannum} % For using Roman numerals.
\usepackage{setspace} % For line spacing
\usepackage{siunitx} % For tables.
\usepackage{subcaption}
\usepackage{tabularx} % For cover art.
\usepackage{tcolorbox} % For cover art.
\usepackage{tikz} % For cover art.
\usepackage{titlesec}
\usepackage{titling}
\usepackage{tocloft} % ToC options.
\usepackage[normalem]{ulem} % For underline.
\usepackage{xurl} % For wrapping long URLs.
\urlstyle{same}

%---------------------------------%
% Colors
%---------------------------------%
\definecolor{Gray}{RGB}{246, 246, 246}
\definecolor{Blue}{RGB}{12, 127, 215}
\definecolor{Dark-Blue}{RGB}{15, 21, 124}
\definecolor{Red}{RGB}{238, 48, 69}
\definecolor{Purple}{RGB}{45, 0, 79}
\definecolor{Yellow}{RGB}{178, 229, 34}
\definecolor{darkText}{RGB}{15, 15, 15}
\definecolor{text}{RGB}{76, 79, 105}
\definecolor{subtext1}{RGB}{92, 95, 119}
\definecolor{subtext0}{RGB}{108, 111, 133}
\definecolor{overlay2}{RGB}{124, 127, 147}
\definecolor{overlay1}{RGB}{140, 143, 161}
\definecolor{overlay0}{RGB}{156, 160, 176}
\definecolor{surface2}{RGB}{172, 176, 190}
\definecolor{surface1}{RGB}{188, 192, 204}
\definecolor{surface0}{RGB}{204, 208, 218}
\definecolor{base}{RGB}{239, 241, 245}
\definecolor{mantle}{RGB}{230, 233, 239}
\definecolor{crust}{RGB}{220, 224, 232}
\definecolor{orange}{RGB}{255, 166, 0}
\definecolor{darkOrange}{RGB}{229, 58, 35}
\definecolor{green}{RGB}{69, 182, 73}
\definecolor{darkGreen}{RGB}{63, 127, 52}
\definecolor{darkestGreen}{RGB}{16, 70, 7}
\definecolor{lightGreen}{RGB}{150, 230, 161}
\definecolor{backgroundGreen}{RGB}{6, 42, 0}
\definecolor{backgroundPurple}{RGB}{69, 182, 26}

%---------------------------------%
% Fonts
%---------------------------------%
\usepackage[scaled]{helvet}
% \usepackage{ebgaramond}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{mathpazo}

%---------------------------------%
% References
%---------------------------------%
\usepackage{natbib}
\bibliographystyle{agsm}
\setcitestyle{authoryear, open={\bfseries}}
\setcitestyle{aysep={,}}
\def\bibfont{\scriptsize}
\setlength{\bibsep}{0pt} % Reducing spacing in the bibliography.
\makeatletter
\newcommand*{\citelink}[1]{\hyper@link{cite}{cite.#1}}
%\newcommand{\citelink}[2]{\hyperlink{cite.\therefsection @#1}{#2}}
\makeatother

%---------------------------------%
% Table of Contents
%---------------------------------%

% Implement table of contents.
\usepackage[numbered, open]{bookmark}
%\bookmarksetup{color = Blue}
%\hypersetup{bookmarksdepth=-2}
 
% Table of contents style.
%\renewcommand\cftaftertoctitle{\par\hfill\null\\\null\hfill\normalsize Page}
\renewcommand{\cftpartleader}{\cftdotfill{\cftdotsep}} % Dots for articles
\setcounter{tocdepth}{2} % Depth of inclusion
\renewcommand\cfttoctitlefont{\bfseries\Large}
\renewcommand{\cftsecfont}{\fontfamily{ptm}\selectfont}
\renewcommand{\cftsubsecfont}{\fontfamily{ptm}\selectfont}
\renewcommand{\cftsecpagefont}{\normalsize\fontfamily{ptm}\selectfont}
\renewcommand{\cftsubsecpagefont}{\normalsize\fontfamily{ptm}\selectfont}
\renewcommand{\cftpartfont}{\normalsize\fontfamily{ptm}\selectfont}

% Font for list of figures.
\renewcommand\cftloftitlefont{\fontfamily{ptm}\selectfont}
\renewcommand\cftfigfont{\fontfamily{ptm}\selectfont}
\renewcommand\cftfigpagefont{\fontfamily{ptm}\selectfont}

% Font for list of tables.
\renewcommand\cftlottitlefont{\fontfamily{ptm}\selectfont}
\renewcommand\cfttabfont{\fontfamily{ptm}\selectfont}
\renewcommand\cfttabpagefont{\fontfamily{ptm}\selectfont}

% TODO: Specify font for table of contents


% Table of contents labels.
\usepackage{etoolbox}
\makeatletter
\let\@nodottedtocline\@dottedtocline
\patchcmd{\@nodottedtocline}{\hbox{.}}{\hbox{}}{}{}
\patchcmd{\@nodottedtocline}{\normalcolor #5}{\normalcolor}{}{}
\newcommand*\l@sectionsubtitle{\@nodottedtocline{1}{0em}{0em}}
\makeatother
\def\sectionsubtitle#1{%
    \addcontentsline{toc}{sectionsubtitle}{\protect\numberline{}\vspace*{1.0\baselineskip}\\ \Large #1}%
}

%---------------------------------%
% Section formatting.
%---------------------------------%

% Section font.
\titleformat{\section}[block]
  {\normalfont\fontsize{18}{18}\bfseries}{\thesection}{1em}{}

% Section spacing.
\titlespacing*{\section}{0pt}{1.5\baselineskip}{0.5\baselineskip}

% Subsection font.
\titleformat{\subsection}[block]{\normalfont\bfseries\fontsize{14}{14}\itshape}{\thesection}{}{}

% Subsection spacing.
\titlespacing*{\subsection}{0pt}{1.25\baselineskip}{0.75\baselineskip}

%---------------------------------%
% General formatting.
%---------------------------------%

\renewcommand{\headrulewidth}{0pt}

% Itemization bullets.
\renewcommand\labelitemi{
  \scriptsize
  \OrnamentDiamondSolid
}

% Itemization spacing.
\setlist[itemize, 1]{leftmargin=*}
\setlist[enumerate, 1]{label=\arabic*., leftmargin=*}
\setlist[enumerate, 2]{label=\alph*)}
\setlist[enumerate, 3]{label=\roman*)}

% Paragraphs spacing.
\setlength{\parskip}{0pt}

% Big fractions.
\newcommand\ddfrac[2]{\frac{\displaystyle #1}{\displaystyle #2}}

%---------------------------------%
% Custom Tags
%---------------------------------%

% Abstracts.
\newcommand\Abstract[1]{%
  \centerline{%
    \begin{minipage}{0.8\textwidth}
      \itshape #1
    \end{minipage}
  }\par\vspace*{0.25in}
}

% Article titles.
\makeatletter
\newenvironment{article-title}[2]{%
  \phantomsection\addcontentsline{toc}{part}{#1}
  \bfseries\Huge
  \begin{center}
    #2
  \end{center}
}
\makeatother

% Advertisement boxes.
\newcommand\AdBlock[2]{%
  \setlength\fboxsep{0pt}
  \setlength\fboxrule{4.0pt}\fbox{%
    \begin{minipage}[c][\dimexpr.475\textheight-2pt\relax][c]{\dimexpr0.475\textwidth}
      \centering #1\par #2
    \end{minipage}
  }
}

% Block quotes.
\usepackage{etoolbox}
\AtBeginEnvironment{quote}{\par\singlespacing\small}

%---------------------------------%
% Table Style
%---------------------------------%
\tcbuselibrary{skins} % For tables.
\usetikzlibrary{calc}
\usetikzlibrary{shadings} % For tables.
\sisetup{ % siunitx setup
  input-symbols = {()},
	group-separator = {,},  
	group-four-digits,
	tight-spacing = true,
	detect-all
}

%%---------------------------------%
% Figures and Tables
%---------------------------------%
\floatsetup[table]{capposition=top}
%\floatsetup[figure]{capposition=top}
\setlength{\textfloatsep}{0.5\baselineskip plus 1.0pt minus 1.0pt}
\setlength\fboxsep{0pt}

% Custom figures.
\newenvironment{Figure}
  {\par\medskip\noindent\minipage{\linewidth}}
  {\endminipage\par\medskip}
 
% Custom tables.
\newenvironment{Table}
  {\par\medskip\noindent\minipage{\linewidth}}
  {\endminipage\par\medskip}

% Colored tables.
\tcbset{
  table-style-1/.style={
    arc = 0mm,
    boxrule = 0.5pt,
    colback = economicon_yellow!10!white,
    colbacktitle = economicon_purple,
    colframe = economicon_purple!50!black,
    coltitle = white, center title,
    enhanced,
    fonttitle = \normalsize\sffamily ,
    fontupper = \normalsize\sffamily ,
    width=\textwidth
  }
}

% Table columns.
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

%\newcolumntype{C}[1]{>{\Centering}m{#1}}
%\renewcommand\tabularxcolumn[1]{C{#1}}
%\newcolumntype{Y}{>{\raggedleft\arraybackslash}X}

%---------------------------------%
% Headers and footers
%---------------------------------%

% Regular page header and footer.
\fancypagestyle{regular}{%
  \fancyhf{}
  \fancyhead[L]{\@title}
  \fancyhead[R]{\@author}
  \fancyfoot{}
  \fancyfoot[C]{Page \thepage\ of \pageref*{LastPage}}
  \fancyfoot[L]{Cannlytics}
  \fancyfoot[R]{\monthname~\the\year{}}
  \renewcommand{\headrulewidth}{0.6pt}
  \renewcommand{\footrulewidth}{0.6pt}
}

% Title page header and footer.
\fancypagestyle{titlepage}{%
  \renewcommand{\footrulewidth}{0.6pt}
  \fancyfoot[L]{\small Cannlytics}
  \fancyfoot[C]{\small Page \thepage\ of \pageref*{LastPage}}
  \fancyfoot[R]{\monthname~\the\year{}}
}

% Fix small head height.
\setlength{\headheight}{14pt}

%---------------------------------%
% Document
%---------------------------------%
\usepackage{subfiles} % Facilitates multiple document files. Best loaded last.
\begin{document}
\newgeometry{
  top=1.0in,
  bottom=1.0in,
  right=1.0in,
  left=1.0in
}

%---------------------------------%
% Cover
%---------------------------------%
\begin{titlepage}
  \subfile{cover}
\end{titlepage}

%---------------------------------%
% Copyright
%---------------------------------%
\fontfamily{ptm}\selectfont
\begin{titlepage}
  \subfile{copyright}
\end{titlepage}
 
%---------------------------------%
%	Table of Contents
%---------------------------------%
\newpage
\newgeometry{
  top=0.5in,
  bottom=0.75in,
  right=0.5in,
  left=0.5in
}

% Rename the TOC title.
\renewcommand{\contentsname}{Table of Contents}

% Control number on sections.
\setcounter{secnumdepth}{0}

% Roman numbering
\pagenumbering{roman}
%\vspace*{1.0\baselineskip}

% Table of contents with list of figures and tables.
{\hypersetup{linkcolor = black}
  \tableofcontents
  \listoffigures
  \listoftables
}

%---------------------------------%
% Body
%---------------------------------%
\newgeometry{
  top=0.75in,
  bottom=0.75in,
  right=0.5in,
  left=0.5in
}
\pagenumbering{arabic}
\subfile{body}

%---------------------------------%
% Appendix
%---------------------------------%
\subfile{appendix}

%---------------------------------%
% End of the document.
%---------------------------------%
\end{document}
