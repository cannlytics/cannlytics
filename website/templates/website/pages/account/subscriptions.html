<!doctype html>
<html>
<!--
  Subscription Management Page | Cannlytics Website
  Copyright (c) 2021-2022 Cannlytics

  Authors: Keegan Skeate <https://github.com/keeganskeate>
  Created: 11/16/2021
  Updated: 1/4/2022
  License: MIT License <https://github.com/cannlytics/cannlytics-website/blob/main/LICENSE>
-->
{% extends "website/index.html" %}
{% load static icon %}
{% block title %}Subscription | Cannlytics{% endblock %}
{% block page_css %}

  <!-- Minor Style Adjustments -->
  <style>
    .tooltip-inner {
      text-
      align: left;
    }
    .bg-purple {
      background-color: #7B4EA8 !important;
    }
    .bg-orange {
      background-color: #FF7F00 !important;
    }
    .bg-green {
      background-color: #16c995 !important;
    }
    .btn-purple {
      background-color: #7B4EA8 !important;
      color: white;
    }
    .btn-orange {
      background-color: #FF7F00 !important;
      color: white;
    }
    .btn-green {
      background-color: #16c995 !important;
      color: white;
    }
  </style>

  <!-- PayPal JavaScript -->
  <script data-sdk-integration-source="integrationbuilder_sc"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=Ae4CcPpl9WnMMNNVxvrhf6MMEpBPsf42UQki5hCivL7cEIQRc89-oWpVEF7sSif8k65CxTWrutGELsHR&components=buttons"></script>
  {% comment %} <script src="https://www.paypal.com/sdk/js?client-id={{ paypal.client_id }}&vault=true&intent=subscription" data-sdk-integration-source="button-factory"></script> {% endcomment %}

{% endblock page_css %}
{% block material %}

{% if not user.email %}

  <!-- Sign In Prompt -->
  <section class="container mb-2 mt-5 d-flex justify-content-center">
    <div class="markdown py-5" style="max-width:560px;">
      <svg class="pe-3 pt-3" style="float:left;width:125px;height:125px;">
        <use href="{% static "website/images/emojies/newspaper.svg" %}#newspaper-emoji"></use>
      </svg>
      <h1 class="pt-4 text-dark">Cannlytics Subscriptions</h1>
      <p class="mt-2">
        You will need to create an account or to sign in
        to take advantage of Cannlytics subscriptions.
      </p>
      <div class="d-flex justify-content-center mt-3">
        <a
          class="btn btn-sm bg-gradient-green text-white serif"
          data-bs-target="#sign-in-dialog"
          data-bs-toggle="modal"
        >
          Sign in &raquo;
        </a>
      </div>
    </div>
  </section>

{% else %}

  <!-- Header -->
  {% include "website/components/heros/hero_banner.html" with
    title="Manage your Cannlytics Subscription"
    description="Explore subscription plans and find the right plan for you."
    background_image="https://firebasestorage.googleapis.com/v0/b/cannlytics.appspot.com/o/assets%2Fimages%2Fai%2Fcannbot-ai.png?alt=media&token=3f2b4dcd-d661-404e-b417-c38768f1cb44"
    background_position="top left"
    only
  %}

  <!-- Subscription Management -->
  <section class="container mb-2 mt-5">

    <!-- FIXME: 
     - If no subscription, then show Upgrade on all.
     - If subscription, then show Cancel on current subscription and Change on others.
    -->
    <div class="markdown mt-3">
      <img src="https://firebasestorage.googleapis.com/v0/b/cannlytics.appspot.com/o/public%2Fimages%2Flogos%2Fcannlytics_calyx_ai.png?alt=media&token=012e8364-8ee2-4d91-9ec2-ab5f55b23059"
        style="float:left;width:125px;height:125px;"
        class="pt-3 pe-3"
      />
      <h1 class="pt-4 text-dark">Cannlytics AI Subscription</h1>
      <p class="mt-2" style="max-width:560px;">
        You can get access to bleeding-edge AI tools to give yourself
        a competitive edge, including:
        <a href="https://data.cannlytics.com/results">a COA parser</a>,
        <a href="https://data.cannlytics.com/sales">a receipt parser</a>,
        <a href="https://data.cannlytics.com/licenses">licenses data archive</a>, and
        <a href="https://cannlytics.com/api">API access</a>.
      </p>
      
      <!-- Tiers -->
      <div class="row row-cols-1 row-cols-md-3 mb-3 mt-4 text-center">
        {% for item in subscription_plans %}
          <div class="col-8 col-md-6 col-lg-4">
            <div class="card mb-4 shadow-sm">
              <div class="card-header bg-gradient-{{ item.color }}">
                <h4 class="fw-bold text-white my-0">
                  {{ item.name }}
                </h4>
              </div>
              <div class="card-body bg-transparent d-flex flex-column justify-content-between align-items-center">
                <h1 class="text-dark card-title pricing-card-title">
                  {{ item.price }}
                </h1>
                <ul class="text-dark list-unstyled mt-3 mb-4 text-start w-75">
                  {% for attribute in item.attributes %}
                      <li class="fs-6 mb-1">
                        <svg class="" style="width:24px;height:24px;">
                          <use href="{% static "website/images/emojies/check.svg" %}#check-emoji"></use>
                        </svg>
                        <small class="serif text-dark">
                          {{ attribute }}
                        </small>
                      </li>
                  {% endfor %}
                </ul>
                <div id="paypal-{{ item.plan_name }}"></div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div><!-- End of tiers -->

    </div><!-- End of support options -->

    

    <!-- TODO: Usage / tokens-->
    {% include "website/pages/account/tokens.html" with
      user=user
      only
    %}
    {% comment %} <div class="row">
      <div class="col-lg-4">
        <div class="card text-center">
          <div class="card-header bg-green">
            <h4 class="text-white serif fw-bold my-2">Free</h4>
          </div>
          <div class="card-body">
            <h5 class="card-title text-dark fw-bold">$0 / month</h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">10 AI jobs</li>
              <li class="list-group-item">Personal archive</li>
              <li class="list-group-item">Access all data</li>
            </ul>
            <button class="btn btn-green mt-3">Select Plan</button>
          </div>
        </div>
      </div>
    
      <div class="col-lg-4">
        <div class="card text-center">
          <div class="card-header bg-orange text-white">
            <h4 class="text-white serif fw-bold my-2">Standard Plan</h4>
          </div>
          <div class="card-body">
            <h5 class="card-title text-dark fw-bold">$4.20 / month</h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">100 AI jobs</li>
              <li class="list-group-item">4.2Â¢ / additional job</li>
              <li class="list-group-item">Throttled API</li>
            </ul>
            <button class="btn btn-orange mt-3">Select Plan</button>
          </div>
        </div>
      </div>
    
      <div class="col-lg-4">
        <div class="card text-center">
          <div class="card-header bg-purple text-white">
            <h4 class="text-white serif fw-bold my-2">Pro Plan</h4>
          </div>
          <div class="card-body">
            <h5 class="card-title text-dark fw-bold">$42 / month</h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">1,250 AI jobs</li>
              <li class="list-group-item">3.3Â¢ / additional job</li>
              <li class="list-group-item">ðŸš€ Unthrottled API</li>
            </ul>
            <button class="btn btn-purple mt-3">Select Plan</button>
          </div>
        </div>
      </div>
    </div> {% endcomment %}

    {% comment %} <!-- Subscribe / unsubscribe from premium material -->
    <div class=" markdown mb-5 mt-3" style="max-width:560px;">
      <svg class="pe-1 pt-3" style="float:left;width:125px;height:125px;">
        <use href="{% static "website/images/emojies/coin.svg" %}#coin-emoji"></use>
      </svg>
      <h1 class="pt-4 text-dark">Premium Material</h1>
      <p class="mt-2">
        You can get premium material to gain a competitive edge, including all
        <a href="{% url 'page' page='data' %}">datasets</a>,
        <a href="{% url 'page' page='videos' %}">premium videos</a>,
        <a href="{% url 'page' page='whitepapers' %}">whitepapers</a>, and
        <a href="{% url 'page' page='api' %}">API access</a>.
      </p>
      <div class="row px-3">
        <div class="col-10 col-md-8 card my-3 p-3 border rounded text-dark">
          <h3 class="mb-3 mt-0">Premium Material</h3>
          <div class="d-flex justify-content-between mb-3">
            <div class="form-check pe-4">
              <input
                id="premium-material-checkbox"
                class="form-check-input"
                type="checkbox"
                value=""
              >
              <label
                class="app-action background-hover form-check-label"
                for="premium-material-checkbox"
              >
                Subscribe to all videos, whitepapers, datasets,
                and API access
              </label>
            </div>
            <div class="text-secondary text-nowrap">$4.20 / mo.</div>
          </div>
        </div>
        <div id="checkout-premium-button" class="col-3 my-3 d-none">
          <div id="paypal-premium"></div>
        </div>
      </div>
      <div class="col-8 d-flex justify-content-end">
        <button
          id="cancel-premium-button"
          class="btn btn-sm btn-sm-light serif me-2 d-none"
        >
          Cancel
        </button>
        <button
          id="save-premium-button"
          class="btn btn-sm bg-gradient-green text-white serif d-none"
        >
          Save
        </button>
      </div>
    </div> {% endcomment %}

    <!-- Subscribe / unsubscribe from newsletter -->
    <div class="markdown mb-5 mt-3" style="max-width:560px;">
      <svg class="pe-1 pt-3" style="float:left;width:125px;height:125px;">
        <use href="{% static "website/images/emojies/newspaper.svg" %}#newspaper-emoji"></use>
      </svg>
      <h1 class="pt-4 text-dark">Free Newsletters</h1>
      <p class="mt-2">
        You can receive periodic newsletters and updates from Cannlytics if you
        believe that you will benefit from our free material, including novel
        datasets and statistics.
      </p>
      <div class="card col-8 my-3 p-3 border rounded text-dark">
        <h3 class="mb-3 mt-0">Newsletters</h3>
        <div class="d-flex justify-content-between mb-3">
          <div class="form-check pe-4">
            <input
              id="free-newsletter-checkbox"
              class="form-check-input"
              type="checkbox"
              value=""
            >
            <label
              class="app-action background-hover form-check-label"
              for="free-newsletter-checkbox"
            >
              Subscribe to Free Weekly Newsletter
            </label>
          </div>
          <div class="text-secondary text-nowrap">Free</div>
        </div>
      </div>
    </div>

    <!-- List sponsorship packages -->
    {% comment %} {% include "website/pages/subscriptions/sponsorships.html" %} {% endcomment %}

  </section>

{% endif %}

{% endblock material %}

<!-- JavaScript -->
{% block page_js %}

<!-- Make user's subscriptions available to JavaScript -->
{{ user.newsletter|json_script:"user_newsletter" }}
{% comment %} {{ user.premium|json_script:"user_premium" }} {% endcomment %}
{{ user.subscriptions|json_script:"user_subscriptions" }}
{{ user.support|json_script:"user_support" }}

<script>

  // FIXME:
  // Initialize the interface with the user's current subscriptions.
  // cannlytics.payments.initializeSubscriptions();
  // cannlytics.payments.initializeSupport();

  // TODO: Automatically unsubscribe user from newsletter if they navigate with
  // special query parameter that is a salted hash of their email.

  // Enable tooltips.
  cannlytics.ui.enableTooltips();

</script>

{% endblock page_js %}
